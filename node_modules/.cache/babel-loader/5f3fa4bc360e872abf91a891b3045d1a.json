{"ast":null,"code":"'use strict';\n\nconst EventEmitter = require('events');\n\nconst JSONB = require('json-buffer');\n\nconst loadStore = options => {\n  const adapters = {\n    redis: '@keyv/redis',\n    mongodb: '@keyv/mongo',\n    mongo: '@keyv/mongo',\n    sqlite: '@keyv/sqlite',\n    postgresql: '@keyv/postgres',\n    postgres: '@keyv/postgres',\n    mysql: '@keyv/mysql'\n  };\n\n  if (options.adapter || options.uri) {\n    const adapter = options.adapter || /^[^:]*/.exec(options.uri)[0];\n    return new (require(adapters[adapter]))(options);\n  }\n\n  return new Map();\n};\n\nclass Keyv extends EventEmitter {\n  constructor(uri, options) {\n    super();\n    this.opts = Object.assign({\n      namespace: 'keyv',\n      serialize: JSONB.stringify,\n      deserialize: JSONB.parse\n    }, typeof uri === 'string' ? {\n      uri\n    } : uri, options);\n\n    if (!this.opts.store) {\n      const adapterOptions = Object.assign({}, this.opts);\n      this.opts.store = loadStore(adapterOptions);\n    }\n\n    if (typeof this.opts.store.on === 'function') {\n      this.opts.store.on('error', error => this.emit('error', error));\n    }\n\n    this.opts.store.namespace = this.opts.namespace;\n  }\n\n  _getKeyPrefix(key) {\n    return `${this.opts.namespace}:${key}`;\n  }\n\n  get(key, options) {\n    const keyPrefixed = this._getKeyPrefix(key);\n\n    const {\n      store\n    } = this.opts;\n    return Promise.resolve().then(() => store.get(keyPrefixed)).then(data => typeof data === 'string' ? this.opts.deserialize(data) : data).then(data => {\n      if (data === undefined) {\n        return undefined;\n      }\n\n      if (typeof data.expires === 'number' && Date.now() > data.expires) {\n        this.delete(key);\n        return undefined;\n      }\n\n      return options && options.raw ? data : data.value;\n    });\n  }\n\n  set(key, value, ttl) {\n    const keyPrefixed = this._getKeyPrefix(key);\n\n    if (typeof ttl === 'undefined') {\n      ttl = this.opts.ttl;\n    }\n\n    if (ttl === 0) {\n      ttl = undefined;\n    }\n\n    const {\n      store\n    } = this.opts;\n    return Promise.resolve().then(() => {\n      const expires = typeof ttl === 'number' ? Date.now() + ttl : null;\n      value = {\n        value,\n        expires\n      };\n      return this.opts.serialize(value);\n    }).then(value => store.set(keyPrefixed, value, ttl)).then(() => true);\n  }\n\n  delete(key) {\n    const keyPrefixed = this._getKeyPrefix(key);\n\n    const {\n      store\n    } = this.opts;\n    return Promise.resolve().then(() => store.delete(keyPrefixed));\n  }\n\n  clear() {\n    const {\n      store\n    } = this.opts;\n    return Promise.resolve().then(() => store.clear());\n  }\n\n}\n\nmodule.exports = Keyv;","map":{"version":3,"sources":["C:/Users/Moa/Desktop/BioBuddy/BioBuddy/node_modules/keyv/src/index.js"],"names":["EventEmitter","require","JSONB","loadStore","options","adapters","redis","mongodb","mongo","sqlite","postgresql","postgres","mysql","adapter","uri","exec","Map","Keyv","constructor","opts","Object","assign","namespace","serialize","stringify","deserialize","parse","store","adapterOptions","on","error","emit","_getKeyPrefix","key","get","keyPrefixed","Promise","resolve","then","data","undefined","expires","Date","now","delete","raw","value","set","ttl","clear","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nconst EventEmitter = require('events');\nconst JSONB = require('json-buffer');\n\nconst loadStore = options => {\n\tconst adapters = {\n\t\tredis: '@keyv/redis',\n\t\tmongodb: '@keyv/mongo',\n\t\tmongo: '@keyv/mongo',\n\t\tsqlite: '@keyv/sqlite',\n\t\tpostgresql: '@keyv/postgres',\n\t\tpostgres: '@keyv/postgres',\n\t\tmysql: '@keyv/mysql',\n\t};\n\tif (options.adapter || options.uri) {\n\t\tconst adapter = options.adapter || /^[^:]*/.exec(options.uri)[0];\n\t\treturn new (require(adapters[adapter]))(options);\n\t}\n\n\treturn new Map();\n};\n\nclass Keyv extends EventEmitter {\n\tconstructor(uri, options) {\n\t\tsuper();\n\t\tthis.opts = Object.assign(\n\t\t\t{\n\t\t\t\tnamespace: 'keyv',\n\t\t\t\tserialize: JSONB.stringify,\n\t\t\t\tdeserialize: JSONB.parse,\n\t\t\t},\n\t\t\t(typeof uri === 'string') ? { uri } : uri,\n\t\t\toptions,\n\t\t);\n\n\t\tif (!this.opts.store) {\n\t\t\tconst adapterOptions = Object.assign({}, this.opts);\n\t\t\tthis.opts.store = loadStore(adapterOptions);\n\t\t}\n\n\t\tif (typeof this.opts.store.on === 'function') {\n\t\t\tthis.opts.store.on('error', error => this.emit('error', error));\n\t\t}\n\n\t\tthis.opts.store.namespace = this.opts.namespace;\n\t}\n\n\t_getKeyPrefix(key) {\n\t\treturn `${this.opts.namespace}:${key}`;\n\t}\n\n\tget(key, options) {\n\t\tconst keyPrefixed = this._getKeyPrefix(key);\n\t\tconst { store } = this.opts;\n\t\treturn Promise.resolve()\n\t\t\t.then(() => store.get(keyPrefixed))\n\t\t\t.then(data => (typeof data === 'string') ? this.opts.deserialize(data) : data)\n\t\t\t.then(data => {\n\t\t\t\tif (data === undefined) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tif (typeof data.expires === 'number' && Date.now() > data.expires) {\n\t\t\t\t\tthis.delete(key);\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\treturn (options && options.raw) ? data : data.value;\n\t\t\t});\n\t}\n\n\tset(key, value, ttl) {\n\t\tconst keyPrefixed = this._getKeyPrefix(key);\n\t\tif (typeof ttl === 'undefined') {\n\t\t\tttl = this.opts.ttl;\n\t\t}\n\n\t\tif (ttl === 0) {\n\t\t\tttl = undefined;\n\t\t}\n\n\t\tconst { store } = this.opts;\n\n\t\treturn Promise.resolve()\n\t\t\t.then(() => {\n\t\t\t\tconst expires = (typeof ttl === 'number') ? (Date.now() + ttl) : null;\n\t\t\t\tvalue = { value, expires };\n\t\t\t\treturn this.opts.serialize(value);\n\t\t\t})\n\t\t\t.then(value => store.set(keyPrefixed, value, ttl))\n\t\t\t.then(() => true);\n\t}\n\n\tdelete(key) {\n\t\tconst keyPrefixed = this._getKeyPrefix(key);\n\t\tconst { store } = this.opts;\n\t\treturn Promise.resolve()\n\t\t\t.then(() => store.delete(keyPrefixed));\n\t}\n\n\tclear() {\n\t\tconst { store } = this.opts;\n\t\treturn Promise.resolve()\n\t\t\t.then(() => store.clear());\n\t}\n}\n\nmodule.exports = Keyv;\n"]},"metadata":{},"sourceType":"script"}